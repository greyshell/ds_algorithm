LIB=foo

all: build-static build-shared clean-object-file

build-static: $(LIB).o
	ar -rcs lib$(LIB).a $(LIB).o
	mv lib$(LIB).a static/

build-shared: $(LIB).o
	gcc -shared -o lib$(LIB).so $(LIB).o
	mv lib$(LIB).so shared/

$(LIB).o: $(LIB).c
	gcc -c -Wall -Werror -fPIC $(LIB).c -o $(LIB).o

clean: clean-object-file clean-shared clean-static

clean-shared:
	rm -f shared/lib$(LIB).so

clean-static:
	rm -f static/lib$(LIB).a

clean-object-file:
	rm -f $(LIB).o